### ============================================================================
### Bank Application API Tests (Bun Version)
### Style: Mentor (Variables & Automation)
### ============================================================================

@baseUrl = http://localhost:3000
@token = {{Login.response.body.data.token}}

### ========================================
### 1. REGISTER USER
### ========================================
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "username": "user1",
  "email": "user1@example.com",
  "password": "password123",
  "fullName": "user1"
}

### ========================================
### 2. LOGIN (AUTOMATED TOKEN)
### ========================================
# @name Login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "username": "user1",
  "password": "password123"
}

### ========================================
### 3. BUAT AKUN BANK
### ========================================
POST {{baseUrl}}/accounts
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "accountName": "Tabungan Masa Depan"
}

### ========================================
### 4. LIHAT DAFTAR AKUN
### ========================================
# Cek 'accountNumber' di response ini buat transfer nanti
GET {{baseUrl}}/accounts
Authorization: Bearer {{token}}

### ========================================
### 5. DEPOSIT
### ========================================
POST {{baseUrl}}/transactions/deposit
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "accountId": 1, 
  "amount": 1000000
}

### ========================================
### 6. WITHDRAW
### ========================================
POST {{baseUrl}}/transactions/withdraw
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "accountId": 1, 
  "amount": 50000
}

### ========================================
### 7. TRANSFER (Updated Logic)
### ========================================
# Pastikan ganti nomor rekening tujuan dengan yang valid (buat user lain dulu kalau perlu)
POST {{baseUrl}}/transactions/transfer
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "fromAccountNumber": "MASUKKAN_REKENING_PENGIRIM",
  "toAccountNumber": "MASUKKAN_REKENING_TUJUAN",
  "amount": 75000,
  "description": "Bayar cicilan otomatis"
}

### ========================================
### 8. CEK HISTORY
### ========================================
GET {{baseUrl}}/transactions/1
Authorization: Bearer {{token}}

### ========================================
### 9. ERROR HANDLING TESTS
### ========================================

### Login Failed (Wrong Password)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "username": "victor_pro",
  "password": "wrongpassword"
}

### Transfer to Self (Should Fail)
POST {{baseUrl}}/transactions/transfer
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "fromAccountNumber": "1234567890",
  "toAccountNumber": "1234567890",
  "amount": 100,
  "description": "Transfer ke diri sendiri"
}